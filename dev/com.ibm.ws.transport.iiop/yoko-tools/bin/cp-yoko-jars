#!/bin/sh

(
    GitDir="${GitDir:-$HOME/work/idea/geronimo-yoko}"
    EclipseDir="${EclipseDir:-$HOME/work/eclipse/rtc}"

    [ -d "$GitDir" ] || { echo "### $GitDir NOT FOUND; aborting."; exit 1; } >&2
    [ -d "$EclipseDir" ] || { echo "### $EclipseDir NOT FOUND; aborting."; exit 1; } >&2

    SrcTemplate="$GitDir/@@SRC@@/target/@@SRC@@-1.5-SNAPSHOT.jar"
    DestTemplate="$EclipseDir/@@DIR@@/lib/@@FILE@@-1.5.SNAPSHOT.jar"
    [ ! -d "$EclipseDir/org.apache.yoko" ] || DestTemplate="${DestTemplate/@@DIR@@/org.apache.yoko}"

    for DestKey in core osgi corba.spec rmi.impl rmi.spec util; do
        SrcKey="yoko-${DestKey//./-}"
        [ "$SrcKey" != "yoko-corba-spec" ] || SrcKey="yoko-spec-corba"
        Src="${SrcTemplate//@@SRC@@/$SrcKey}"

        [ -f "$Src" ] || { echo "### $Src NOT FOUND; skipping."; continue; }

        DestKey="org.apache.yoko.$DestKey"
        Dest="${DestTemplate/@@FILE@@/$DestKey}"
        [ "${Dest#*@@DIR@@}" = "$Dest" ] || Dest="${Dest/@@DIR@@/com.ibm.ws.$DestKey}"

        cp -v "$Src" "$Dest"
    done
)
