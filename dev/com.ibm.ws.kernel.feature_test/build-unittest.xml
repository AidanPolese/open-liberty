<project name="com.ibm.ws.kernel.feature_test" default="unittest">
  <import file="../ant_build/public_imports/standard_imports.xml"/>
  <import file="../ant_build/public_imports/unittest_imports.xml"/>
  <import file="../ant_build/public_imports/internal_imports/wlpbnd.xml"/>
  
  <!-- property name="extra.vmargs" value="-Xdebug -Xrunjdwp:transport=dt_socket,address=127.0.0.1:7777" / -->

  <target name="unittestPackage"
        description="create and package test bundles" >

    <property name="unittest.build.dir" value="${build.dir}/unittest" />
    <property name="unittest.lib.dir" value="${unittest.build.dir}/test data/lib" />

      <!-- Create the distribution directory -->
      <mkdir dir="${unittest.lib.dir}"/>

    <copy todir="${unittest.build.dir}" overwrite="true" includeemptydirs="true" >
      <fileset dir="unittest">
        <include name="test data/**"/>
      	<include name="resolverData/**" />
      </fileset>
    </copy>

    <path id="bnd.class.path" location="${unittest.classes.dir}" />
    
	  <!--  <bnd> apparently tolerates absent files on classpath string, but not on classpathref. So: -->
	  <!-- It also has problems with comma as delimiter, despite claims -->
      <wlpbnd eclipse="false" 
           failok="false" 
           exceptions="true" 
           classpathref="bnd.class.path"
           output="${unittest.lib.dir}/simple_1.jar" 
           files="unittest/simple.bnd"/>
      
	  <!--  <bnd> apparently tolerates absent files on classpath string, but not on classpathref. So: -->
	  <!-- It also has problems with comma as delimiter, despite claims -->
      <wlpbnd eclipse="false" 
           failok="false" 
           exceptions="true" 
	       classpathref="bnd.class.path"
           output="${unittest.lib.dir}/simple_2.jar" 
           files="unittest/simple2.bnd"/>
      
	  <!--  <bnd> apparently tolerates absent files on classpath string, but not on classpathref. So: -->
	  <!-- It also has problems with comma as delimiter, despite claims -->
      <wlpbnd eclipse="false" 
           failok="false" 
           exceptions="true" 
	   	   classpathref="bnd.class.path"
           output="${unittest.lib.dir}/simple_3.jar" 
           files="unittest/simple3.bnd"/>
      
	  <!--  <bnd> apparently tolerates absent files on classpath string, but not on classpathref. So: -->
	  <!-- It also has problems with comma as delimiter, despite claims -->
      <wlpbnd eclipse="false" 
           failok="false" 
           exceptions="true" 
	       classpathref="bnd.class.path"
           output="${unittest.lib.dir}/simple_4.jar" 
           files="unittest/simple4.bnd"/>
  </target>
</project>
